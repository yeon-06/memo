# 마이크로 서비스 패턴

### 시작하기 전에

본 책을 우테코 4기 크루들과 스터디를 통해 읽기로 하였다! OT를 진행하며 정한 규칙 등을 간단하게 메모한다.

- 1장부터 읽는다
- 주에 1장 단위로 읽는다
- 모임은 매주 일요일 11시 게더로 모인다

# 1장. 모놀리식 지옥에서 벗어나라

### 헥사고날 아키텍처; 육각형 아키텍처
- 비즈니스 로직은 각자가 도메인 객체 컬렉션인 모듈로 구성(ex 주문관리, 배달관리, 지불, ...)
- 외부 시스템과 연결하는 어댑터가 여럿 존재
  - 인바운드 어댑터: REST API, Web UI 어댑터 등 비즈니스 요청을 호출하여 처리
  - 아웃바운드 어댑터: 비즈니스 로직에서 DB나 클라우드 서비스를 호출하게 해줌
- 논리적으로 모듈화한 아키텍처이지만 애플리케이션은 WAR 파일 하나로 패키징

### 모놀리식 아키텍처

장점 
- 개발이 간단
- 애플리케이션의 변경이 쉬움
- 테스트가 쉬움
- 배포가 쉬움
- 확장이 쉬움

하지만 시간이 흐를수록 애플리케이션이 거대해지고 세분화되며 개발, 테스트, 배포, 확징이 어려워진다

### 마이크로 서비스 아키텍처

- 경계 컨텍스트가 있는, 느슨하게 결한된 엘리먼트로 구성된 서비스 지향 아키텍처

확장 큐브
- X축 확장: 다중 인스턴스에 요청을 고르게 분산
- Z축 확장: 요청 속성별 라우팅 (=라우터가 요청 속성에 알맞은 인스턴스로 요청을 라우팅, 각 애플리케이션은 자신에게 배정된 사용자 하위 집합만 처리)
- Y축 확장: 기능에 따라 애플리케이션을 서비스로 분해

MSA의 특징
- 모듈성을 갖고 있다
- 서비스마다 DB가 따로 있다 -> 다른 서비스가 DB 락을 획득해 블로킹하는 일이 없다
- 서로 느슨하게 결합되어 있고, 오직 API를 통해서만 통신한다

SOA vs MSA
||SOA|MSA|
|---|---|---|
|서비스 간 통신|SOAP, WS 같은 무거운 프로토콜을 응용한 스마트 파이프 활용|메시지 브로커, REST, gRPC같은 가벼운 프로토콜을 이용해 덤 파이프 활용|
|데이터|전역 데이터 모델 및 공유 DB|서비스 개별 데이터 모델 및 DB|

MSA 장점
- 크고 복잡한 애플리케이션의 지속적 전달, 배포가 가능
  - 지속적 통합: 코드를 모두 취합해 테스트하기까지 완벽한 코드를 기다리지 않고 개발 프로세스 전반에 걸쳐 "통합" 중 수행된 단계를 조금씩, 자주 실행하는 관행
  - 지속적 전달 = continuous delivery: 지속적 통합으로 확립된 빌드 및 테스트 자동화의 토대를 기반으로 삼는다
- 서비스가 작아 관리가 용이
- 서비스를 독립적으로 배포/확장할 수 있음 (=독립적으로 X/Z축 확장이 가능)
- 결함 격리가 잘됨
- 신기술 시험/도입이 쉬움

MSA 단점
- MSA에 맞게 시스템을 여러 서비스로 분해하는 구체적으로 정립된 알고리즘이 따로 없음
- 분산 시스템으로 인한 복잡성 -> 개발, 테스트, 배포가 어려움
- 여러 서비스에 걸친 기능을 배포할 때 복잡도 up
- MSA 도입 시점을 알기 어려움
