# 로그 (= 로그 세그먼트)
- 카프카의 토픽으로 들어오는 메시지는 세그먼트(=로그 세그먼트)라는 파일에 저장
- 메시지의 내용, 키, 밸류, 오프셋, 메시지 크기 같은 정보 저장
- 파일들은 브로커의 로컬 디스크에 위치

### 로그 세그먼트가 너무 커진다면
- 파일 관리가 어려워짐
- default 크기: 최대 1GB
- 롤링 전략 사용
  - 최대 크기에 도달하면 해당 파일 close
  - 새로운 로그 세그먼트 생성

### 로그 세그먼트 관리 방법

#### 로그 세그먼트 삭제

- default 설정임
- 특정 기간 동안 로그 세그먼트 보관 시간 설정 (default: 7d)
- 지정된 크기를 기준으로도 삭제 가능 (default 아님)

#### 컴팩션; compaction

- 로그를 삭제하지 않고 압축(compaction)하여 보관
- 로그 세그먼트 컴팩션 시 메시지의 키값을 기준으로 마지막 데이터만 보관
  - ex: 카프카 `__consumer_offset` 토픽. (컨슈머 그룹의 정보를 저장하는 토픽)
- 과거 정보가 중요하지 않고, 가장 마지막 값이 필요한 경우에 사용
- 빠른 장애 복구에 이용 가능 (전체를 복구하지 않고 최신 상태만 복구하니 복구 시간을 줄일 수 있음)
- 모든 토픽에 로그 컴팩션 적용은 좋지 않음
  - 로그 컴팩션 작업이 실행되는 동안 브로커의 과도한 입출력 부하가 발생할 수 있으니 유의해야 함
  - 브로커의 리소스 모니터링과 병행할 것
