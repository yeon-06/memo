# Broker

- 카프카가 설치되어 있는 설치 단위
- 보통 3개 이상의 브로커를 사용하는 것을 권장


# Replication

- 파티션의 복제
- replication: 2 -> 원본(리더 파티션) 1개 + 복제본(팔로워 파티션) 1개
- replication: 3 -> 원본(리더 파티션) 1개 + 복제본(팔로워 파티션) 2개
- 브로커 개수에 따라 replication 개수가 제한됨
  - broker 3개 + replication 4개 (X)
- 파티션의 고가용성을 위해 사용
  - 불가피한 이유로 리더 파티션이 존재하는 브로커가 사용 불가능할 때 사용 가능한 브로커에 존재하는 팔로워 파티션이 리더 파티션 역할을 이어받는다
- 레플리케이션이 많아질수록 브로커의 리소스 사용량도 늘어남 (=많을수록 좋은건 아니다)

> **ISR; In Sync Replication**  
> 레플리케이션의 논리적 그룹을 의미하는 것으로 leader partition + follwer partition으로 구성되어 있다.  
> ISR에 속하지 않은 팔로워는 새로운 리더의 자격을 갖지 못한다.

# ack

- 프로듀서에 존재하는 상세 옵션
- 프로듀서가 리더 파티션에 데이터를 전송하고 옵션에 따라 응답을 받아옴
  - 응답값을 받지 않으면 속도는 빠르지만 데이터 유실 가능성이 있음

|옵션|`0`|`1`|`all`|
|------|---|---|---|
|리더 파티션에 데이터 잘 전송되었는지 확인|X|O|O|
|팔로워 파티션에 데이터 잘 복제되었는지 확인|X|X|O|

<img width="851" alt="image" src="https://user-images.githubusercontent.com/53105735/223708325-e7bb32d3-53e4-4dbd-9f3e-568fc37c354c.png">

***
참고: 인프런 - [데브원영] 아파치 카프카 for beginnders
